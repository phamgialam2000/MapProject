@{
    ViewBag.Title = "Home Page";
}
@model List<MapProject.Models.Patient>
<style>
</style>
<button id="toggleNavbar">☰</button>
<div id="navbar">
    <nav class="navbar-expand-lg navbar-light bg-light flex-column" id="sidebar">
        <div class="mapBoxPanel-icon d-flex" id="mapBoxPanel-icon">
            <div>
                <ul class="nav flex-column icon-menu bg-primary text-white">
                    <li onclick="openTabPanel(event, 0)" class="nav-item text-center py-3 active" data-bs-toggle="tooltip" title="Home">
                        <i class="fas fa-home"></i>
                    </li>
                    <li onclick="openTabPanel(event, 1)" class="nav-item text-center py-3" data-bs-toggle="tooltip" title="Biểu đồ">
                        <i class="fas fa-chart-line"></i>
                    </li>
                    <li onclick="getLocation()" class="nav-item text-center py-3" data-bs-toggle="tooltip" title="Vị trí hiện tại">
                        <i class="fas fa-map-marker-alt"></i>
                    </li>
                </ul>
            </div>
            <div class="align-items-start mapBoxPanel" id="mapBoxPanel">
                <div class="slider-pannel-main">
                    <div class="slider-pannel active">
                        <div class="d-grid">
                            <div style="display: flex; align-items: center; margin:20px 10px;">
                                <input type="text" id="searchBox" placeholder="Tìm kiếm theo tên..."
                                       style="padding:6px 17px; width: 190px; border: 1px solid #ccc; border-radius: 4px;">
                                <button onclick="searchByName()"
                                        style="padding: 6px 10px; background-color: #007bff; color: white; border: none; border-radius: 4px;">
                                    <i class="fas fa-search"></i>
                                </button>
                            </div>
                            <ul id="resultList">
                                @foreach (var item in Model)
                                {
                                    <li class="search-item" onclick='handleItemClick(@Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(item)))'>
                                        @item.Name
                                    </li>
                                }
                            </ul>
                        </div>
                    </div>
                    <div class="slider-pannel">
                        <h4 style="text-align: center; padding: 2rem 0 1rem 0; color: rgb(51, 122, 183);font-weight:bold">Biểu đồ: Chức năng chưa hoàn thành</h4>
                    </div>
                </div>
            </div>
        </div>
    </nav>
</div>
<div id="controlsWidget" class="esri-widget">
    <a id="takeScreenshotButton" class="btn">Chụp màn hình</a>
</div>
<div id="map"></div>
<div id="infoDiv" class="esri-widget">
    Thống kê nhóm đối tượng:
    <select id="filter" class="esri-select">
        <option value="">Tất cả</option>
        <option value="level_1">Cấp độ 1</option>
        <option value="level_2">Cấp độ 2</option>
        <option value="level_3">Cấp độ 3</option>
    </select>
    <div style="padding-top: 10px">
        <button id="toggle-cluster" class="esri-button">Lọc</button>
    </div>
    <div id="legendDiv"></div>
</div>

<script>
    var pointSearch = {};

    $(document).ready(function () {
        MapInit();
    });
    var patient = @Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(Model));

        // Example of using the data
        //patient.forEach(item => {
        //    console.log(`ID: ${item.ID}, Name: ${item.NAME}, Lat: ${item.LATITUDE}, Lng: ${item.LONGITUDE}`);
        //});
    function searchByName() {
        let searchValue = document.getElementById("searchBox").value.toLowerCase();
        let listItems = document.querySelectorAll(".search-item");

        listItems.forEach(item => {
            let itemName = item.textContent || item.innerText;
            if (itemName.toLowerCase().includes(searchValue)) {
                item.style.display = "";
            } else {
                item.style.display = "none";
            }
        });
    }

    const toggleBtn = document.getElementById("toggleNavbar");
    const navbar = document.getElementById("navbar");

    toggleBtn.addEventListener("click", function () {
        navbar.classList.toggle("collapsed");
        toggleBtn.classList.toggle("collapsed");
        setTimeout(function () {
            //view.resize();
        }, 300);
    });



    const openTabPanel = (e, index) => {
        let menuItems = document.querySelectorAll(".icon-menu .nav-item");

        let panels = document.querySelectorAll(".slider-pannel");
        panels.forEach(panel => panel.classList.remove('active'));
        panels[index].classList.add('active');

        menuItems.forEach(item => item.classList.remove('active'));
        menuItems[index].classList.add('active');

    };



    function handleItemClick(item) {
        console.log("You clicked on:", item);
        pointSearch = {
            type: "point",
            longitude: item.LONGITUDE,
            latitude: item.LATITUDE,
            Name: "Bệnh nhân",
            Location: item?.NAME,
            symbol: {
                type: "picture-marker",
                url: "https://static-00.iconduck.com/assets.00/map-marker-icon-171x256-xkl73sge.png",
                width: "50px",
                height: "50px"
            },
            popupTemplate: {
                title: item.NAME,
                content: `Vị trí nhà bệnh nhân: <b>${item?.ADDRESS}</b>.<br>
                           Cấp độ bệnh: <b>${item?.LEVEL}</b>.<br>
                           Ghi chú: <b>${item?.NOTE}</b>.<br>`
            }
        };
        MapInit(pointSearch);
    }


    function getLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(showPosition);
        } else {
            x.innerHTML = "Geolocation is not supported by this browser.";
        }
    }

    function showPosition(position) {
        let item = {
            LATITUDE: position.coords.latitude,
            LONGITUDE: position.coords.longitude
        }
        handleItemClick(item);

    }

    var point_medical_quarantine_facility = {
        title: "{Name}",
        content: "Cơ sở cách ly y tế <b>{Location}</b>."
    };
    var point_template_home = {
        title: "{Name}",
        content: "Vị trí nhà bệnh nhân <b>{Location}</b>."
    };
    var point_template_warning = {
        title: "{Name}",
        content: "Khu vực báo động <b>{Location}</b>."
    };
    var point_template_area = {
        title: "{Name}",
        content: "Khu vực này ở <b>{Location}</b>."
    };

    var jsondata = {
        "points": [
            //{
            //    type: "point",
            //    longitude: 106.720364,
            //    latitude: 10.793904,
            //    Name: "Trạm y tế",
            //    Location: "Bệnh viện Đa khoa Quốc tế Vinmec Central Park",
            //    symbol: {
            //        type: "picture-marker",
            //        url: "https://cdn-icons-png.flaticon.com/512/10714/10714002.png",
            //        width: "50px",
            //        height: "50px"
            //    },
            //    popupTemplate: point_medical_quarantine_facility
            //},
            {
                type: "point",
                longitude: 106.704593,
                latitude: 10.820779,
                Name: "Trạm y tế",
                Location: "Bệnh viện Đa khoa Gia Định",
                symbol: {
                    type: "picture-marker",
                    url: "https://cdn-icons-png.flaticon.com/512/10714/10714002.png",
                    width: "50px",
                    height: "50px"
                },
                popupTemplate: point_medical_quarantine_facility
            },
            {
                type: "point",
                longitude: 106.696662,
                latitude: 10.798007,
                Name: "Trạm y tế",
                Location: "Bệnh viện Quận Bình Thạnh",
                symbol: {
                    type: "picture-marker",
                    url: "https://cdn-icons-png.flaticon.com/512/10714/10714002.png",
                    width: "50px",
                    height: "50px"
                },
                popupTemplate: point_medical_quarantine_facility
            },
            {
                type: "point",
                longitude: 106.689503,
                latitude: 10.790049,
                Name: "Trạm y tế",
                Location: "Bệnh viện Quận 1",
                symbol: {
                    type: "picture-marker",
                    url: "https://cdn-icons-png.flaticon.com/512/10714/10714002.png",
                    width: "50px",
                    height: "50px"
                },
                popupTemplate: point_medical_quarantine_facility
            },
            {
                type: "point",
                longitude: 106.671221,
                latitude: 10.771789,
                Name: "Trạm y tế",
                Location: "Bệnh viện Đa khoa Vạn Hạnh",
                symbol: {
                    type: "picture-marker",
                    url: "https://cdn-icons-png.flaticon.com/512/10714/10714002.png",
                    width: "50px",
                    height: "50px"
                },
                popupTemplate: point_medical_quarantine_facility
            },
            {
                type: "point",
                longitude: 106.664355,
                latitude: 10.755566,
                Name: "Trạm y tế",
                Location: "Bệnh viện Đại học Y Dược TP.HCM",
                symbol: {
                    type: "picture-marker",
                    url: "https://cdn-icons-png.flaticon.com/512/10714/10714002.png",
                    width: "50px",
                    height: "50px"
                },
                popupTemplate: point_medical_quarantine_facility
            },
            {
                type: "point",
                longitude: 106.683932,
                latitude: 10.784674,
                Name: "Trạm y tế",
                Location: "Bệnh viện Quận 3",
                symbol: {
                    type: "picture-marker",
                    url: "https://cdn-icons-png.flaticon.com/512/10714/10714002.png",
                    width: "50px",
                    height: "50px"
                },
                popupTemplate: point_medical_quarantine_facility
            },
            {
                type: "point",
                longitude: 106.693133,
                latitude: 10.765175,
                Name: "Trạm y tế",
                Location: "Bệnh viện Quận 1 (CS2)",
                symbol: {
                    type: "picture-marker",
                    url: "https://cdn-icons-png.flaticon.com/512/10714/10714002.png",
                    width: "50px",
                    height: "50px"
                },
                popupTemplate: point_medical_quarantine_facility
            },
            {
                type: "point",
                longitude: 106.701996,
                latitude: 10.765415,
                Name: "Trạm y tế",
                Location: "Bệnh viện Quận 4",
                symbol: {
                    type: "picture-marker",
                    url: "https://cdn-icons-png.flaticon.com/512/10714/10714002.png",
                    width: "50px",
                    height: "50px"
                },
                popupTemplate: point_medical_quarantine_facility
            },
            {
                type: "point",
                longitude: 106.746364,
                latitude: 10.793640,
                Name: "Trạm y tế",
                Location: "Bệnh Viện Quốc Tế Mỹ (AIH)",
                symbol: {
                    type: "picture-marker",
                    url: "https://cdn-icons-png.flaticon.com/512/10714/10714002.png",
                    width: "50px",
                    height: "50px"
                },
                popupTemplate: point_medical_quarantine_facility
            },

        ],
        //"lines": [
        //{
        //    type: "polyline",
        //    paths: [
        //        [
        //            106.69994263148499,
        //            10.80946322067085
        //        ],
        //        [
        //            106.69994263148499,
        //            10.805776738032804
        //        ],
        //        [
        //            106.70937887924805,
        //            10.805776738032804
        //        ],
        //        [
        //            106.70937887924805,
        //            10.80946322067085
        //        ],
        //        [
        //            106.69994263148499,
        //            10.80946322067085
        //        ]
        //    ],
        //    symbol: {
        //        type: "simple-line",
        //        color: [5, 2, 5],
        //        width: 2
        //    },
        //    Name: "Khu vực cách ly",
        //    Location: "Khu vực cách ly",
        //    popupTemplate: point_template_area
        //},
        //{
        //    type: "polyline",
        //    paths: [
        //        [
        //            106.72375991983762,
        //            10.78155611027131
        //        ],
        //        [
        //            106.72353229073934,
        //            10.779703328707797
        //        ],
        //        [
        //            106.72590613704375,
        //            10.780501942849753
        //        ],
        //        [
        //            106.72558095262019,
        //            10.781651943489791
        //        ],
        //        [
        //            106.72375991983762,
        //            10.78155611027131
        //        ]
        //    ],
        //    symbol: {
        //        type: "simple-line",
        //        color: [5, 2, 5],
        //        width: 2
        //    },
        //    Name: "Khu vực cách ly",
        //    Location: "Khu vực cách ly",
        //    popupTemplate: point_template_area
        //},
        //{
        //    type: "polyline",
        //    paths: [
        //        [
        //            106.68806695220161,
        //            10.781521107253354
        //        ],
        //        [
        //            106.6880775990818,
        //            10.780224196285985
        //        ],
        //        [
        //            106.69007921242667,
        //            10.781364223159315
        //        ],
        //        [
        //            106.68806695220161,
        //            10.781521107253354
        //        ]
        //    ],
        //    symbol: {
        //        type: "simple-line",
        //        color: [5, 2, 5],
        //        width: 2
        //    },
        //    Name: "Khu vực cách ly",
        //    Location: "Khu vực cách ly",
        //    popupTemplate: point_template_area
        //},
        //{
        //    type: "polyline",
        //    paths: [
        //        [
        //            106.70516648409682,
        //            10.784917831250922
        //        ],
        //        [
        //            106.70516648409682,
        //            10.783147725184065
        //        ],
        //        [
        //            106.70672815603535,
        //            10.78451660812155
        //        ],
        //        [
        //            106.70516648409682,
        //            10.784917831250922
        //        ]
        //    ],
        //    symbol: {
        //        type: "simple-line",
        //        color: [5, 2, 5],
        //        width: 2
        //    },
        //    Name: "Khu vực cách ly",
        //    Location: "Khu vực cách ly",
        //    popupTemplate: point_template_area
        //},
        //],
        "lines": [
            {
                type: "polyline",
                paths: [
                    [106.6838586, 10.8071124], [106.6838762, 10.8073245], [106.6839311, 10.8076913], [106.684101, 10.8081502], [106.6841849, 10.8085424], [106.6841826, 10.8086846], [106.6841795, 10.8088836], [106.6841463, 10.8091955], [106.6840003, 10.8094525], [106.6839697, 10.8099393], [106.6841205, 10.8105078], [106.684228, 10.8108681], [106.6843665, 10.8109725], [106.6845424, 10.8111052], [106.6848003, 10.811273], [106.6851743, 10.8115165], [106.685226, 10.8122181], [106.6852722, 10.8124058], [106.6852938, 10.8126358], [106.6852352, 10.8129444], [106.6849025, 10.8133076], [106.6847885, 10.8136435], [106.6849241, 10.8138191], [106.6850781, 10.8139825], [106.685417, 10.8141338], [106.6860486, 10.8143396], [106.6868928, 10.8145484], [106.6874526, 10.814735], [106.6876908, 10.8149024], [106.6878787, 10.8151879], [106.6880828, 10.8154982], [106.6882869, 10.8158084], [106.6888645, 10.8154187], [106.6890935, 10.8152025], [106.6892267, 10.815095], [106.6893781, 10.8149727], [106.6918837, 10.8158453], [106.6917124, 10.8162809], [106.6914798, 10.8165085], [106.6915631, 10.8180184], [106.6919288, 10.818122], [106.6922648, 10.8182522], [106.6925815, 10.8183622], [106.6926825, 10.8183855], [106.6927867, 10.8183765], [106.6930343, 10.8186155], [106.6932113, 10.8186998], [106.693442, 10.818763], [106.6937049, 10.8187735], [106.6939999, 10.8188051], [106.6942118, 10.8188373], [106.6944387, 10.8188886], [106.6946721, 10.8189851], [106.6943521, 10.8199799], [106.693643, 10.8215341], [106.6936064, 10.8216592], [106.6934816, 10.8220864], [106.6934452, 10.8222108], [106.6954927, 10.8226217], [106.6972915, 10.8230424], [106.698628, 10.8233549], [106.6985672, 10.8239327], [106.6986103, 10.8242353], [106.6986473, 10.8244774], [106.6988137, 10.8249314], [106.6988815, 10.825119], [106.6989616, 10.8252885], [106.6990355, 10.8255185], [106.6991649, 10.8257], [106.699319, 10.8258574], [106.6994299, 10.8259966], [106.6995778, 10.8261358], [106.6997318, 10.8262871], [106.7000523, 10.8265111], [106.700348, 10.8266624], [106.7007609, 10.8268137], [106.7009519, 10.8269408], [106.7010505, 10.8270316], [106.7010936, 10.8271345], [106.7010752, 10.8272555], [106.7010135, 10.8274673], [106.7008903, 10.8278486], [106.700804, 10.8281392], [106.7007116, 10.8282481], [106.700613, 10.8283147], [106.7004651, 10.8283813], [106.7002864, 10.8284297], [106.7000831, 10.828472], [106.6998736, 10.8285084], [106.699738, 10.8285991], [106.6996517, 10.8286718], [106.6996517, 10.8287626], [106.6996887, 10.8289018], [106.699738, 10.8291136], [106.6998304, 10.8294283], [106.6998982, 10.8296523], [106.6999352, 10.8298217], [106.699966, 10.8299488], [106.6999228, 10.8300699], [106.6998427, 10.8302091], [106.6997565, 10.8302999], [106.6996394, 10.8303483], [106.6994853, 10.8303846], [106.699319, 10.8304088], [106.6990786, 10.830427], [106.6984501, 10.830433], [106.6979202, 10.8304935], [106.6972978, 10.8305722], [106.6962769, 10.8307923], [106.6952232, 10.8309559], [106.6956523, 10.832094], [106.6959527, 10.8326419], [106.6963604, 10.8330423], [106.6968325, 10.8333374], [106.6975835, 10.8336325], [106.6987208, 10.8339697], [106.6995791, 10.8343912], [106.7001155, 10.8350656], [106.700373, 10.8355081], [106.700652, 10.8362247], [106.7008451, 10.8368148], [106.7011026, 10.8374049], [106.7014888, 10.8380793], [106.7028406, 10.839133], [106.7044285, 10.8381425], [106.7062953, 10.8365197], [106.7078403, 10.8344965], [106.7084196, 10.8319886], [106.7085055, 10.8316092], [106.7086128, 10.8299232], [106.7089132, 10.8268672], [106.7091063, 10.8253498], [106.7103294, 10.8229893], [106.7124966, 10.8214296], [106.7129396, 10.821329], [106.7143328, 10.8210125], [106.7159298, 10.8206498], [106.7180112, 10.8204391], [106.7205647, 10.8206287], [106.7229465, 10.8209238], [106.7240401, 10.8212307], [106.7248991, 10.8214718], [106.7265728, 10.8222095], [106.7286971, 10.8233897], [106.7299417, 10.8243803], [106.731315, 10.8256027], [106.7326024, 10.8270358], [106.7342118, 10.8292277], [106.7361215, 10.8328948], [106.7375377, 10.8344333], [106.739426, 10.835466], [106.7413357, 10.8355503], [106.7439106, 10.834918], [106.7470649, 10.8337378], [106.7491463, 10.832094], [106.7504767, 10.8298389], [106.7508844, 10.8289959], [106.7511204, 10.8280264], [106.7513779, 10.8241906], [106.7511419, 10.8208395], [106.7513564, 10.8180364], [106.7511848, 10.8162238], [106.7508844, 10.8136103], [106.7506467, 10.813059], [106.7501119, 10.8118188], [106.7483953, 10.809669], [106.7462066, 10.8087837], [106.7438463, 10.8083622], [106.7410568, 10.8089313], [106.7378167, 10.8106174], [106.7377308, 10.8106596], [106.7369154, 10.8116713], [106.7362288, 10.8133152], [106.7354778, 10.8159709], [106.7347053, 10.8175516], [106.7339114, 10.8186265], [106.7326024, 10.8192588], [106.7309073, 10.8194274], [106.7289975, 10.8190059], [106.7273238, 10.818205], [106.7259437, 10.8171926], [106.7256287, 10.8169615], [106.7240623, 10.8150435], [106.7230752, 10.8129148], [106.7223972, 10.8106943], [106.7222291, 10.8090429], [106.7222852, 10.8081438], [106.7232939, 10.8057768], [106.7244707, 10.8040704], [106.7260398, 10.8021254], [106.7270299, 10.7998501], [106.7271912, 10.7989824], [106.7274222, 10.79774], [106.7273288, 10.7968592], [106.7269738, 10.7944921], [106.7264695, 10.7925471], [106.7251432, 10.7902901], [106.7237982, 10.788712], [106.7224159, 10.7876661], [106.7207908, 10.7866568], [106.7190102, 10.7859745], [106.7168215, 10.7855213], [106.7151836, 10.7852975], [106.7135957, 10.7871103], [106.7128876, 10.7875951], [106.7124714, 10.7877187], [106.7119563, 10.7877667], [106.711334, 10.7877034], [106.7105508, 10.7875243], [106.7098963, 10.7874241], [106.7094457, 10.7874663], [106.7089522, 10.787598], [106.7087058, 10.7877698], [106.7084029, 10.7881221], [106.7078879, 10.7887966], [106.7073086, 10.7899559], [106.7069438, 10.7910098], [106.7066434, 10.7914946], [106.706426, 10.7916975], [106.7062142, 10.7918951], [106.7050341, 10.792422], [106.703296, 10.7928647], [106.7016008, 10.793223], [106.7008713, 10.7933495], [106.7005267, 10.7934105], [106.6995624, 10.7935813], [106.6979516, 10.7936737], [106.6975106, 10.7936686], [106.696451, 10.7935813], [106.6959991, 10.7935004], [106.6956571, 10.7934338], [106.6951421, 10.7933916], [106.6949542, 10.7934056], [106.6948255, 10.7934478], [106.6946914, 10.7935189], [106.6945894, 10.7936191], [106.6945413, 10.7937499], [106.6945198, 10.7947195], [106.694509, 10.7948205], [106.6944446, 10.7948969], [106.6943829, 10.7949522], [106.6942381, 10.794976], [106.6938117, 10.7949303], [106.6930831, 10.7948172], [106.6925457, 10.7948882], [106.6916659, 10.7954573], [106.6915377, 10.7955228], [106.6919505, 10.796059], [106.6920004, 10.7972037], [106.6920049, 10.7973064], [106.6920319, 10.7977868], [106.6919769, 10.7978053], [106.6917786, 10.7978216], [106.6917983, 10.7983222], [106.6919364, 10.7983187], [106.6919206, 10.7984976], [106.6918616, 10.7986557], [106.6917919, 10.7993249], [106.6918348, 10.7997781], [106.6917865, 10.7999678], [106.6917489, 10.8000679], [106.6917597, 10.8001575], [106.6918026, 10.8002681], [106.6918723, 10.8003156], [106.6921352, 10.8004157], [106.6924839, 10.8004842], [106.6923837, 10.8009708], [106.6923516, 10.8010314], [106.6922532, 10.8010059], [106.6919096, 10.80089], [106.6919927, 10.8009515], [106.6920004, 10.801115], [106.6919881, 10.8013586], [106.6921965, 10.801419], [106.692211, 10.8015558], [106.6920352, 10.8023002], [106.6915598, 10.8022923], [106.6912484, 10.8023986], [106.6910058, 10.8024245], [106.6906713, 10.8023823], [106.6908648, 10.8033558], [106.687924, 10.8037436], [106.6882684, 10.8048203], [106.6885225, 10.8056313], [106.6870475, 10.8061622], [106.6870708, 10.8052455], [106.686749, 10.8053419], [106.6861863, 10.8055208], [106.685772, 10.8057672], [106.6849879, 10.8061742], [106.6842993, 10.8065375], [106.6839104, 10.8069884], [106.6838586, 10.8071124]
                ],
                Name: "Quận Bình Thạnh",
                Location: "Quận Bình Thạnh, Tp.Hồ Chí Minh",
                symbol: {
                    type: "simple-fill",
                    color: [233, 206, 205, 0.5],
                    outline: {
                        color: [214, 114, 101],
                        width: 1
                    }
                },
                popupTemplate: point_medical_quarantine_facility
            },
            {
                type: "polyline",
                paths: [
                    [106.6659201, 10.7908067], [106.6660183, 10.7909908], [106.666538, 10.7915774], [106.6682211, 10.793784], [106.6687128, 10.7943666], [106.6672204, 10.795583], [106.6672599, 10.7958157], [106.6673175, 10.7961492], [106.6674557, 10.7971436], [106.6675897, 10.7983227], [106.6679545, 10.7982779], [106.6681589, 10.7990646], [106.6688674, 10.7990303], [106.6689878, 10.7990449], [106.6690363, 10.7991278], [106.6691575, 10.7993555], [106.6674159, 10.8003001], [106.667936, 10.8011886], [106.6683705, 10.8024427], [106.6688372, 10.8025639], [106.6692396, 10.8043923], [106.6694714, 10.8066259], [106.6699244, 10.8068623], [106.6704482, 10.8071126], [106.6704553, 10.8080582], [106.670972, 10.808079], [106.6709154, 10.8087465], [106.6706535, 10.8087465], [106.6707224, 10.8099399], [106.6716926, 10.8101382], [106.672252, 10.8111621], [106.6721306, 10.8117951], [106.6720652, 10.8122354], [106.6721341, 10.8130494], [106.672396, 10.813812], [106.672738, 10.8141994], [106.6760522, 10.8112022], [106.6769531, 10.8122594], [106.678511, 10.8109618], [106.6785282, 10.8111393], [106.6785475, 10.8113383], [106.6785881, 10.8117569], [106.6786076, 10.8120592], [106.6805469, 10.8119029], [106.6813207, 10.8112802], [106.6811604, 10.8108686], [106.6818907, 10.8104692], [106.6820293, 10.8106901], [106.6827369, 10.8104182], [106.6834563, 10.8100897], [106.6838851, 10.8099944], [106.6839697, 10.8099393], [106.6840003, 10.8094525], [106.6841463, 10.8091955], [106.6841795, 10.8088836], [106.6841826, 10.8086846], [106.6841849, 10.8085424], [106.684101, 10.8081502], [106.6839311, 10.8076913], [106.6838762, 10.8073245], [106.6838586, 10.8071124], [106.6839104, 10.8069884], [106.6842993, 10.8065375], [106.6849879, 10.8061742], [106.685772, 10.8057672], [106.6861863, 10.8055208], [106.686749, 10.8053419], [106.6870708, 10.8052455], [106.6870475, 10.8061622], [106.6885225, 10.8056313], [106.6882684, 10.8048203], [106.687924, 10.8037436], [106.6908648, 10.8033558], [106.6906713, 10.8023823], [106.6910058, 10.8024245], [106.6912484, 10.8023986], [106.6915598, 10.8022923], [106.6920352, 10.8023002], [106.692211, 10.8015558], [106.6921965, 10.801419], [106.6919881, 10.8013586], [106.6920004, 10.801115], [106.6919927, 10.8009515], [106.6919096, 10.80089], [106.6922532, 10.8010059], [106.6923516, 10.8010314], [106.6923837, 10.8009708], [106.6924839, 10.8004842], [106.6921352, 10.8004157], [106.6918723, 10.8003156], [106.6918026, 10.8002681], [106.6917597, 10.8001575], [106.6917489, 10.8000679], [106.6917865, 10.7999678], [106.6918348, 10.7997781], [106.6917919, 10.7993249], [106.6918616, 10.7986557], [106.6919206, 10.7984976], [106.6919364, 10.7983187], [106.6917983, 10.7983222], [106.6917786, 10.7978216], [106.6919769, 10.7978053], [106.6920319, 10.7977868], [106.6920049, 10.7973064], [106.6920004, 10.7972037], [106.6919505, 10.796059], [106.6915377, 10.7955228], [106.6910275, 10.7957664], [106.6908343, 10.7957901], [106.6905607, 10.7957848], [106.6898607, 10.7956979], [106.689343, 10.7956162], [106.6888549, 10.7955003], [106.6879752, 10.7950146], [106.6875461, 10.794846], [106.6873314, 10.7948205], [106.6871384, 10.7948882], [106.6869827, 10.7950181], [106.6868809, 10.7952043], [106.6862612, 10.7965225], [106.6861217, 10.7967254], [106.6859125, 10.796894], [106.6857222, 10.7969538], [106.6854592, 10.7969309], [106.6852688, 10.7968677], [106.6850998, 10.7967676], [106.6849282, 10.7965955], [106.684845, 10.7963934], [106.6848128, 10.7961721], [106.6848289, 10.7959508], [106.6849362, 10.7952948], [106.6850381, 10.794557], [106.685081, 10.7944358], [106.6851481, 10.7942988], [106.6852419, 10.7942013], [106.6859153, 10.7936024], [106.6863015, 10.7932862], [106.686387, 10.793049], [106.6863444, 10.7928014], [106.6861523, 10.7925164], [106.6860038, 10.7923452], [106.6858737, 10.7922556], [106.6857061, 10.7922082], [106.685538, 10.7922097], [106.6851143, 10.7922518], [106.6844813, 10.7923678], [106.6841969, 10.7924099], [106.683918, 10.7924046], [106.6834245, 10.792373], [106.6830398, 10.7922595], [106.6827341, 10.7920962], [106.6824106, 10.791883], [106.6819616, 10.7915745], [106.6817082, 10.7913149], [106.6815956, 10.7911674], [106.681499, 10.7909856], [106.6814021, 10.7905023], [106.6804976, 10.7908624], [106.6804143, 10.7908956], [106.6803118, 10.7909364], [106.6797391, 10.791414], [106.6788164, 10.7910293], [106.6780677, 10.7909736], [106.6746328, 10.7904506], [106.6739285, 10.7900997], [106.67367, 10.7898752], [106.6721844, 10.7896137], [106.672172, 10.7892547], [106.6719434, 10.7891487], [106.6714384, 10.7891045], [106.6709951, 10.7891902], [106.6708942, 10.7889035], [106.6706947, 10.7879308], [106.6687742, 10.7885789], [106.6671274, 10.7892482], [106.6668967, 10.7894537], [106.6667304, 10.789596], [106.6667036, 10.7898015], [106.6667519, 10.7900597], [106.6667728, 10.7902378], [106.6665904, 10.7904802], [106.6662149, 10.7907279], [106.6659201, 10.7908067]
                ],
                Name: "Quận Phú Nhuận",
                Location: "Quận Phú Nhuận, Tp.Hồ Chí Minh",
                symbol: {
                    type: "simple-fill",
                    color: [233, 206, 205, 0.5],
                    outline: {
                        color: [198, 99, 0],
                        width: 1
                    }
                },
                popupTemplate: point_medical_quarantine_facility
            },
            {
                type: "polyline",
                paths: [
                    [106.6816512, 10.7654274], [106.6818712, 10.7657373], [106.6843154, 10.7682012], [106.6844808, 10.7683679], [106.6872399, 10.7712886], [106.6894226, 10.7736279], [106.6949544, 10.7795562], [106.6980875, 10.7828693], [106.6919813, 10.7878903], [106.6887017, 10.7904466], [106.6861523, 10.7925164], [106.6863444, 10.7928014], [106.686387, 10.793049], [106.6863015, 10.7932862], [106.6859153, 10.7936024], [106.6852419, 10.7942013], [106.6851481, 10.7942988], [106.685081, 10.7944358], [106.6850381, 10.794557], [106.6849362, 10.7952948], [106.6848289, 10.7959508], [106.6848128, 10.7961721], [106.684845, 10.7963934], [106.6849282, 10.7965955], [106.6850998, 10.7967676], [106.6852688, 10.7968677], [106.6854592, 10.7969309], [106.6857222, 10.7969538], [106.6859125, 10.796894], [106.6861217, 10.7967254], [106.6862612, 10.7965225], [106.6868809, 10.7952043], [106.6869827, 10.7950181], [106.6871384, 10.7948882], [106.6873314, 10.7948205], [106.6875461, 10.794846], [106.6879752, 10.7950146], [106.6888549, 10.7955003], [106.689343, 10.7956162], [106.6898607, 10.7956979], [106.6905607, 10.7957848], [106.6908343, 10.7957901], [106.6910275, 10.7957664], [106.6915377, 10.7955228], [106.6916659, 10.7954573], [106.6925457, 10.7948882], [106.6930831, 10.7948172], [106.6938117, 10.7949303], [106.6942381, 10.794976], [106.6943829, 10.7949522], [106.6944446, 10.7948969], [106.694509, 10.7948205], [106.6945198, 10.7947195], [106.6945413, 10.7937499], [106.6945894, 10.7936191], [106.6946914, 10.7935189], [106.6948255, 10.7934478], [106.6949542, 10.7934056], [106.6951421, 10.7933916], [106.6956571, 10.7934338], [106.6959991, 10.7935004], [106.696451, 10.7935813], [106.6975106, 10.7936686], [106.6979516, 10.7936737], [106.6995624, 10.7935813], [106.7005267, 10.7934105], [106.7008713, 10.7933495], [106.7016008, 10.793223], [106.703296, 10.7928647], [106.7050341, 10.792422], [106.7062142, 10.7918951], [106.706426, 10.7916975], [106.7066434, 10.7914946], [106.7069438, 10.7910098], [106.7073086, 10.7899559], [106.7078879, 10.7887966], [106.7084029, 10.7881221], [106.7087058, 10.7877698], [106.7089522, 10.787598], [106.7094457, 10.7874663], [106.7098963, 10.7874241], [106.7105508, 10.7875243], [106.711334, 10.7877034], [106.7119563, 10.7877667], [106.7124714, 10.7877187], [106.7128876, 10.7875951], [106.7135957, 10.7871103], [106.7151836, 10.7852975], [106.713542, 10.7841329], [106.71123, 10.7825151], [106.7102215, 10.7811292], [106.7093793, 10.7791531], [106.7086819, 10.7769661], [106.7083815, 10.7749688], [106.7082205, 10.7731982], [106.7081991, 10.7714064], [106.7082448, 10.7706306], [106.7082795, 10.7703577], [106.7084384, 10.7695891], [106.7064395, 10.7690846], [106.7063607, 10.7690647], [106.7051741, 10.7687464], [106.7039322, 10.7681088], [106.7030428, 10.7676208], [106.7024737, 10.7670405], [106.7020213, 10.7664016], [106.7014694, 10.765518], [106.7014421, 10.7654864], [106.7013079, 10.7653316], [106.7009309, 10.7650611], [106.7003419, 10.7646921], [106.7000133, 10.7644863], [106.6998327, 10.7643925], [106.6991821, 10.7640546], [106.6985136, 10.7635987], [106.697996, 10.7630828], [106.6979731, 10.7630508], [106.6972244, 10.7620035], [106.6970706, 10.7617884], [106.6969099, 10.7615755], [106.6963877, 10.7608836], [106.6959468, 10.7603402], [106.6952862, 10.7597949], [106.6947078, 10.7594646], [106.6943171, 10.7592414], [106.692762, 10.758339], [106.6926659, 10.7582833], [106.6922899, 10.7580156], [106.6918549, 10.7577288], [106.6913135, 10.7573215], [106.6904469, 10.7565556], [106.6890914, 10.7553575], [106.6878741, 10.7541309], [106.6869967, 10.7532468], [106.6867091, 10.754147], [106.6863102, 10.754827], [106.686014, 10.75521], [106.685785, 10.7554718], [106.6855499, 10.7558161], [106.6852288, 10.7564432], [106.6851488, 10.7565526], [106.6821368, 10.764154], [106.68176, 10.7652], [106.6816512, 10.7654274]
                ],
                Name: "Quận 1",
                Location: "Quận 1, Tp.Hồ Chí Minh",
                symbol: {
                    type: "simple-fill",
                    color: [131, 132, 171, 0.5],
                    outline: {
                        color: [227, 139, 79],
                        width: 1
                    }
                },
                popupTemplate: point_medical_quarantine_facility
            },
            {
                type: "polyline",
                paths: [
                    [106.7081991, 10.7714064], [106.7082205, 10.7731982], [106.7083815, 10.7749688], [106.7086819, 10.7769661], [106.7093793, 10.7791531], [106.7102215, 10.7811292], [106.71123, 10.7825151], [106.713542, 10.7841329], [106.7151836, 10.7852975], [106.7168215, 10.7855213], [106.7190102, 10.7859745], [106.7207908, 10.7866568], [106.7224159, 10.7876661], [106.7237982, 10.788712], [106.7251432, 10.7902901], [106.7264695, 10.7925471], [106.7269738, 10.7944921], [106.7273288, 10.7968592], [106.7274222, 10.79774], [106.7271912, 10.7989824], [106.7270299, 10.7998501], [106.7260398, 10.8021254], [106.7244707, 10.8040704], [106.7232939, 10.8057768], [106.7222852, 10.8081438], [106.7222291, 10.8090429], [106.7223972, 10.8106943], [106.7230752, 10.8129148], [106.7240623, 10.8150435], [106.7256287, 10.8169615], [106.7259437, 10.8171926], [106.7273238, 10.818205], [106.7289975, 10.8190059], [106.7309073, 10.8194274], [106.7326024, 10.8192588], [106.7339114, 10.8186265], [106.7347053, 10.8175516], [106.7354778, 10.8159709], [106.7362288, 10.8133152], [106.7369154, 10.8116713], [106.7377308, 10.8106596], [106.7378167, 10.8106174], [106.7410568, 10.8089313], [106.7438463, 10.8083622], [106.7462066, 10.8087837], [106.7483953, 10.809669], [106.7501119, 10.8118188], [106.7506467, 10.813059], [106.7530907, 10.8131149], [106.7552142, 10.8131914], [106.7562689, 10.8132679], [106.7569841, 10.8132549], [106.7574156, 10.813247], [106.7581234, 10.8134208], [106.7590578, 10.8136224], [106.7599709, 10.8140883], [106.7606292, 10.814422], [106.7610185, 10.8145472], [106.7619387, 10.8145611], [106.7624625, 10.8144011], [106.7627527, 10.814276], [106.7632907, 10.813977], [106.7637224, 10.8134764], [106.7641428, 10.8125472], [106.7642609, 10.8112721], [106.7643789, 10.8105344], [106.764572, 10.8100496], [106.7648831, 10.8096281], [106.7654839, 10.8091644], [106.7659688, 10.8087444], [106.7663246, 10.8085234], [106.7668378, 10.8082913], [106.7672435, 10.8081843], [106.7676425, 10.8081754], [106.7682218, 10.8082702], [106.7690587, 10.8083967], [106.7699793, 10.8083951], [106.7709342, 10.8082475], [106.7715779, 10.8080684], [106.7721144, 10.8078154], [106.7727903, 10.8075941], [106.773552, 10.8076152], [106.7743578, 10.8077661], [106.7751294, 10.8079816], [106.775724, 10.8082388], [106.776545, 10.8089272], [106.7767718, 10.8090625], [106.7769582, 10.8087336], [106.7770173, 10.8085233], [106.7771113, 10.808083], [106.7777786, 10.8058761], [106.7783937, 10.8037682], [106.7799714, 10.7983604], [106.7804397, 10.7967409], [106.7810626, 10.7946147], [106.7811178, 10.7943619], [106.7814417, 10.7934591], [106.7815527, 10.7929759], [106.7816265, 10.792655], [106.7816504, 10.7923444], [106.7816198, 10.7909996], [106.7816429, 10.7904471], [106.7855845, 10.7906551], [106.7868351, 10.7906711], [106.7868375, 10.790148], [106.7868805, 10.7894313], [106.7869234, 10.7886198], [106.7869985, 10.7876291], [106.7871272, 10.7865805], [106.7872613, 10.7855318], [106.7872238, 10.7850312], [106.7869931, 10.7846992], [106.7866981, 10.7844357], [106.7861938, 10.7842091], [106.7855608, 10.7839245], [106.7850941, 10.7836031], [106.7847293, 10.7832711], [106.7842626, 10.7828811], [106.7840373, 10.7826598], [106.7838764, 10.782428], [106.7838549, 10.7821961], [106.7838925, 10.7819379], [106.7840427, 10.7817323], [106.7843216, 10.7814847], [106.784901, 10.7811053], [106.7854428, 10.7808523], [106.7865157, 10.7803306], [106.7881304, 10.7794664], [106.7898953, 10.7785442], [106.7906624, 10.7784071], [106.7930173, 10.7784388], [106.794058, 10.7785125], [106.7956191, 10.7787918], [106.796413, 10.7788445], [106.7969656, 10.7788024], [106.7974913, 10.7786179], [106.7979633, 10.7782069], [106.7981457, 10.7778117], [106.7983818, 10.776647], [106.7985749, 10.7762992], [106.7987144, 10.7761464], [106.7992293, 10.7759672], [106.7999482, 10.7759619], [106.8006938, 10.7759251], [106.8010211, 10.7758987], [106.8015199, 10.7756721], [106.8021817, 10.7753255], [106.8032334, 10.774016], [106.8033558, 10.7738636], [106.8035275, 10.7733261], [106.8033022, 10.77223], [106.8032915, 10.7718084], [106.8038923, 10.770923], [106.8056713, 10.7695715], [106.8052142, 10.7686419], [106.8046622, 10.7670314], [106.8038509, 10.7643648], [106.8034011, 10.7631931], [106.8032183, 10.7628535], [106.8027078, 10.7621394], [106.8018691, 10.760943], [106.8013778, 10.760408], [106.8003974, 10.7596965], [106.7997835, 10.7592974], [106.7993177, 10.7589946], [106.7968881, 10.7577716], [106.7928651, 10.7561097], [106.7909369, 10.7553139], [106.788688, 10.7543858], [106.7853359, 10.7530425], [106.7834782, 10.7522195], [106.7834293, 10.7521969], [106.7773151, 10.7493683], [106.774151, 10.7476922], [106.7726629, 10.7466967], [106.7708469, 10.7452907], [106.7697018, 10.7442035], [106.7686561, 10.7431427], [106.7679284, 10.7423222], [106.7673814, 10.7415364], [106.7667858, 10.7403457], [106.763649, 10.742013], [106.762352, 10.7426662], [106.7614136, 10.7431545], [106.7607651, 10.743392], [106.759697, 10.7436485], [106.7585373, 10.7438173], [106.7574234, 10.7438593], [106.7563553, 10.7437925], [106.7555008, 10.743619], [106.7545319, 10.7433138], [106.7522507, 10.7424297], [106.7501297, 10.7415524], [106.7489471, 10.7414761], [106.7478561, 10.7414408], [106.7470245, 10.7416945], [106.7459412, 10.742362], [106.7452011, 10.7431936], [106.7443695, 10.7441921], [106.7441483, 10.7449007], [106.7440414, 10.7452278], [106.743721, 10.7469692], [106.7436829, 10.7484999], [106.7438583, 10.7497816], [106.7442627, 10.7511206], [106.7455292, 10.7531214], [106.7467651, 10.7548923], [106.7484055, 10.7565174], [106.7501297, 10.7578716], [106.750679, 10.7584476], [106.7511215, 10.7591763], [106.7515564, 10.7600889], [106.7521667, 10.761776], [106.7523727, 10.7627354], [106.7525177, 10.7635508], [106.7525558, 10.7640438], [106.7525406, 10.7644882], [106.7524643, 10.7652693], [106.7522736, 10.766221], [106.7519913, 10.7672663], [106.7518005, 10.7679482], [106.7514038, 10.7690353], [106.7510452, 10.7697716], [106.7505798, 10.770483], [106.7501297, 10.770957], [106.7491302, 10.7717934], [106.7482376, 10.7725677], [106.7475128, 10.7731953], [106.7466583, 10.7741518], [106.7452393, 10.7753916], [106.7442169, 10.776083], [106.7436752, 10.77635], [106.7430115, 10.7766762], [106.7416382, 10.7771721], [106.7404099, 10.7773991], [106.7393494, 10.7774048], [106.7379227, 10.7772913], [106.7370834, 10.777051], [106.7363663, 10.7765675], [106.7354507, 10.7753754], [106.7349777, 10.7744007], [106.7346954, 10.7734747], [106.7344513, 10.7718763], [106.7342987, 10.7706556], [106.734314, 10.7688456], [106.7340088, 10.7656603], [106.7335434, 10.763588], [106.7329178, 10.7620916], [106.7322159, 10.7609787], [106.7311325, 10.7600594], [106.729805, 10.7595987], [106.7277069, 10.7592564], [106.7240906, 10.758935], [106.7220459, 10.7591724], [106.7201892, 10.7597523], [106.7174148, 10.7610375], [106.7144582, 10.7625566], [106.7118135, 10.7643323], [106.7100923, 10.766217], [106.7090853, 10.7681436], [106.7084384, 10.7695891], [106.7082795, 10.7703577], [106.7082448, 10.7706306], [106.7081991, 10.7714064]
                ],
                Name: "Quận 2",
                Location: "Quận 2, Tp.Hồ Chí Minh",
                symbol: {
                    type: "simple-fill",
                    color: [131, 132, 171, 0.5],
                    outline: {
                        color: [202, 113, 0],
                        width: 1
                    }
                },
                popupTemplate: point_medical_quarantine_facility
            },
            {
                type: "polyline",
                paths: [
                    [106.6642244, 10.7871435], [106.6645685, 10.7876304], [106.6655985, 10.7890637], [106.66562, 10.7894484], [106.665282, 10.7898542], [106.6664354, 10.7899965], [106.6667519, 10.7900597], [106.6667036, 10.7898015], [106.6667304, 10.789596], [106.6668967, 10.7894537], [106.6671274, 10.7892482], [106.6687742, 10.7885789], [106.6706947, 10.7879308], [106.6708942, 10.7889035], [106.6709951, 10.7891902], [106.6714384, 10.7891045], [106.6719434, 10.7891487], [106.672172, 10.7892547], [106.6721844, 10.7896137], [106.67367, 10.7898752], [106.6739285, 10.7900997], [106.6746328, 10.7904506], [106.6780677, 10.7909736], [106.6788164, 10.7910293], [106.6797391, 10.791414], [106.6803118, 10.7909364], [106.6804143, 10.7908956], [106.6804976, 10.7908624], [106.6814021, 10.7905023], [106.681499, 10.7909856], [106.6815956, 10.7911674], [106.6817082, 10.7913149], [106.6819616, 10.7915745], [106.6824106, 10.791883], [106.6827341, 10.7920962], [106.6830398, 10.7922595], [106.6834245, 10.792373], [106.683918, 10.7924046], [106.6841969, 10.7924099], [106.6844813, 10.7923678], [106.6851143, 10.7922518], [106.685538, 10.7922097], [106.6857061, 10.7922082], [106.6858737, 10.7922556], [106.6860038, 10.7923452], [106.6861523, 10.7925164], [106.6887017, 10.7904466], [106.6919813, 10.7878903], [106.6980875, 10.7828693], [106.6949544, 10.7795562], [106.6894226, 10.7736279], [106.6872399, 10.7712886], [106.6844808, 10.7683679], [106.6843154, 10.7682012], [106.6818712, 10.7657373], [106.6816512, 10.7654274], [106.6814069, 10.7655282], [106.6786957, 10.7663607], [106.6744385, 10.7676679], [106.6745777, 10.7678824], [106.675235, 10.7688693], [106.6758054, 10.7696037], [106.6763401, 10.7701855], [106.6765258, 10.770384], [106.6767143, 10.7705882], [106.6771689, 10.7710769], [106.677564, 10.7714951], [106.6778244, 10.7717355], [106.6780527, 10.7719153], [106.6781996, 10.7720352], [106.6783766, 10.7721839], [106.6790235, 10.7727322], [106.6795139, 10.7731617], [106.6795935, 10.7732315], [106.6802085, 10.7737333], [106.681099, 10.7745133], [106.6818822, 10.7751773], [106.6823838, 10.7756173], [106.6824795, 10.7756977], [106.6828042, 10.775966], [106.6824131, 10.7765044], [106.6819071, 10.7772889], [106.6817892, 10.7775546], [106.6816483, 10.7778282], [106.6814113, 10.7779799], [106.6738676, 10.782002], [106.6714072, 10.7833138], [106.668978, 10.784609], [106.6644275, 10.7870424], [106.6642244, 10.7871435]
                ],
                Name: "Quận 3",
                Location: "Quận 3, Tp.Hồ Chí Minh",
                symbol: {
                    type: "simple-fill",
                    color: [233, 206, 205, 0.5],
                    outline: {
                        color: [204, 153, 0],
                        width: 1
                    }
                },
                popupTemplate: point_medical_quarantine_facility
            },
            {
                type: "polyline",
                paths: [
                    [106.6863906, 10.7518373], [106.6864121, 10.7519849], [106.6864979, 10.7524487], [106.686734, 10.7528914], [106.6869967, 10.7532468], [106.6878741, 10.7541309], [106.6890914, 10.7553575], [106.6904469, 10.7565556], [106.6913135, 10.7573215], [106.6918549, 10.7577288], [106.6922899, 10.7580156], [106.6926659, 10.7582833], [106.692762, 10.758339], [106.6943171, 10.7592414], [106.6947078, 10.7594646], [106.6952862, 10.7597949], [106.6959468, 10.7603402], [106.6963877, 10.7608836], [106.6969099, 10.7615755], [106.6970706, 10.7617884], [106.6972244, 10.7620035], [106.6979731, 10.7630508], [106.697996, 10.7630828], [106.6985136, 10.7635987], [106.6991821, 10.7640546], [106.6998327, 10.7643925], [106.7000133, 10.7644863], [106.7003419, 10.7646921], [106.7009309, 10.7650611], [106.7013079, 10.7653316], [106.7014421, 10.7654864], [106.7014694, 10.765518], [106.7020213, 10.7664016], [106.7024737, 10.7670405], [106.7030428, 10.7676208], [106.7039322, 10.7681088], [106.7051741, 10.7687464], [106.7063607, 10.7690647], [106.7064395, 10.7690846], [106.7084384, 10.7695891], [106.7090853, 10.7681436], [106.7100923, 10.766217], [106.7118135, 10.7643323], [106.7144582, 10.7625566], [106.7174148, 10.7610375], [106.7201892, 10.7597523], [106.7220459, 10.7591724], [106.7211227, 10.7569542], [106.7206817, 10.7560959], [106.7205887, 10.7559147], [106.7203445, 10.7554436], [106.7195435, 10.7542639], [106.7185974, 10.7534389], [106.7179565, 10.7530279], [106.7169189, 10.7527399], [106.715818, 10.7526501], [106.7144089, 10.7525587], [106.7141093, 10.7525628], [106.7102127, 10.752512], [106.7100983, 10.752511], [106.7058182, 10.7524958], [106.7049255, 10.7525005], [106.7021754, 10.7523609], [106.7011857, 10.7523327], [106.7006117, 10.7523538], [106.6998553, 10.752338], [106.6991579, 10.7523485], [106.6984928, 10.7523854], [106.6979295, 10.7523854], [106.696642, 10.7523802], [106.6952776, 10.7523595], [106.6915619, 10.7523854], [106.6913581, 10.7523433], [106.691004, 10.75228], [106.6906822, 10.7521641], [106.6902101, 10.7520798], [106.6878905, 10.7518916], [106.6870129, 10.7518373], [106.6863906, 10.7518373]
                ],
                Name: "Quận 4",
                Location: "Quận 4, Tp.Hồ Chí Minh",
                symbol: {
                    type: "simple-fill",
                    color: [131, 132, 171, 0.5],
                    outline: {
                        color: [214, 114, 101],
                        width: 1
                    }
                },
                popupTemplate: point_medical_quarantine_facility
            },
            {
                type: "polyline",
                paths: [
                    [106.68170403252913, 10.765454436552616], [106.6743812726325, 10.767672787073266], [106.67572038610132, 10.769499914554913], [106.67669992357361, 10.770584005539206], [106.67766706183556, 10.771570646752181], [106.68276313624347, 10.775931320513536], [106.68174602412012, 10.777558862044316], [106.68166354176287, 10.777882971531653], [106.66463883452337, 10.786887102219993], [106.66317078302666, 10.785360208593332], [106.66256793462657, 10.784559642021478], [106.66043563750907, 10.782388231553782], [106.65847629020283, 10.78029883786077], [106.6564479288989, 10.77814007766456], [106.65633912271966, 10.778115400983992], [106.65622404764935, 10.77811385242211], [106.65610424346676, 10.778144823653975], [106.65603015403758, 10.778186634812798], [106.65617611905185, 10.777627661850076], [106.6599853444223, 10.763836044349205], [106.66151693507493, 10.75842931625941], [106.67474515656323, 10.761067214256599], [106.67486781954784, 10.761134164183332], [106.68137291013835, 10.765360818786519], [106.68170445701116, 10.76545359427972]
                ],
                Name: "Quận 10",
                Location: "Quận 10, Tp.Hồ Chí Minh",
                symbol: {
                    type: "simple-fill",
                    color: [233, 206, 205, 0.5],
                    outline: {
                        color: [202, 113, 0],
                        width: 1
                    }
                },
                popupTemplate: point_medical_quarantine_facility
            },
            {
                type: "polyline",
                paths: [
                    [106.6504807, 10.7510379], [106.650769, 10.7533595], [106.6509622, 10.755189], [106.6511021, 10.7562772], [106.6528822, 10.7566351], [106.6560108, 10.7572969], [106.6582695, 10.7577422], [106.6615635, 10.758391], [106.662748, 10.758694], [106.6655946, 10.7592632], [106.6672301, 10.7595459], [106.6689208, 10.7598381], [106.6731487, 10.7607941], [106.6750201, 10.7612815], [106.6752675, 10.7614388], [106.6754273, 10.7615404], [106.6764909, 10.7622168], [106.6786796, 10.7636294], [106.6806123, 10.7649212], [106.6816512, 10.7654274], [106.68176, 10.7652], [106.6821368, 10.764154], [106.6851488, 10.7565526], [106.6852288, 10.7564432], [106.6855499, 10.7558161], [106.685785, 10.7554718], [106.686014, 10.75521], [106.6863102, 10.754827], [106.6867091, 10.754147], [106.6869967, 10.7532468], [106.686734, 10.7528914], [106.6864979, 10.7524487], [106.6864121, 10.7519849], [106.6863906, 10.7518373], [106.6862477, 10.7515969], [106.6857367, 10.7512847], [106.6852694, 10.7511317], [106.6845227, 10.7510075], [106.682946, 10.7515083], [106.6816834, 10.7518694], [106.6811737, 10.7520325], [106.6806283, 10.7519742], [106.679757, 10.7518636], [106.6792192, 10.7517806], [106.6780617, 10.7517471], [106.677706, 10.7517063], [106.6774452, 10.7515957], [106.6772615, 10.7514792], [106.6770007, 10.7512055], [106.676728, 10.7506872], [106.6762538, 10.7495225], [106.6760424, 10.7493787], [106.6757651, 10.7490724], [106.6751098, 10.7486956], [106.6746237, 10.7486956], [106.6739539, 10.7486839], [106.6733493, 10.7487422], [106.6729877, 10.7488878], [106.6720868, 10.7491149], [106.6714821, 10.7494002], [106.6706049, 10.7494002], [106.6697217, 10.7495575], [106.6681449, 10.7498137], [106.6666808, 10.7501282], [106.6659518, 10.7502446], [106.6655191, 10.7502214], [106.6649678, 10.7501282], [106.6635926, 10.7496506], [106.6612394, 10.7488354], [106.6581334, 10.7477813], [106.6573094, 10.747461], [106.6566278, 10.7470825], [106.6549911, 10.7461928], [106.6543238, 10.747456], [106.6538614, 10.748565], [106.65376, 10.748957], [106.6533721, 10.7504601], [106.653322, 10.7511547], [106.6527792, 10.7510798], [106.6504807, 10.7510379]
                ],
                Name: "Quận 5",
                Location: "Quận 5, Tp.Hồ Chí Minh",
                symbol: {
                    type: "simple-fill",
                    color: [233, 206, 205, 0.5],
                    outline: {
                        color: [202, 113, 0],
                        width: 1
                    }
                },
                popupTemplate: point_medical_quarantine_facility
            },
            {
                type: "polyline",
                paths: [
                    [106.6901905, 10.7296001], [106.6902337, 10.7299452], [106.6903015, 10.7302298], [106.6904247, 10.7305749], [106.6905664, 10.7308594], [106.6908684, 10.7311561], [106.691423, 10.7315254], [106.6930944, 10.7327683], [106.6937774, 10.7335791], [106.6943507, 10.734366], [106.6947653, 10.7353007], [106.694871, 10.735784], [106.6948792, 10.7363991], [106.6947938, 10.7367866], [106.694684, 10.7372739], [106.6945295, 10.7377851], [106.6941718, 10.7383244], [106.6939522, 10.7386878], [106.6929986, 10.7400871], [106.6921011, 10.7415766], [106.6918411, 10.7418928], [106.6918411, 10.7422972], [106.6919098, 10.7426109], [106.6920471, 10.7429018], [106.6923218, 10.7433043], [106.6926804, 10.7440319], [106.692749, 10.7445698], [106.6927261, 10.7450857], [106.692688, 10.7457151], [106.6925583, 10.7463894], [106.6923523, 10.7469511], [106.6922148, 10.7474466], [106.6919401, 10.7479794], [106.6915738, 10.7485059], [106.6908337, 10.749415], [106.6904447, 10.7500553], [106.6903148, 10.7510323], [106.6902101, 10.7520798], [106.6906822, 10.7521641], [106.691004, 10.75228], [106.6913581, 10.7523433], [106.6915619, 10.7523854], [106.6952776, 10.7523595], [106.696642, 10.7523802], [106.6979295, 10.7523854], [106.6984928, 10.7523854], [106.6991579, 10.7523485], [106.6998553, 10.752338], [106.7006117, 10.7523538], [106.7011857, 10.7523327], [106.7021754, 10.7523609], [106.7049255, 10.7525005], [106.7058182, 10.7524958], [106.7100983, 10.752511], [106.7102127, 10.752512], [106.7141093, 10.7525628], [106.7144089, 10.7525587], [106.715818, 10.7526501], [106.7169189, 10.7527399], [106.7179565, 10.7530279], [106.7185974, 10.7534389], [106.7195435, 10.7542639], [106.7203445, 10.7554436], [106.7205887, 10.7559147], [106.7206817, 10.7560959], [106.7211227, 10.7569542], [106.7220459, 10.7591724], [106.7240906, 10.758935], [106.7277069, 10.7592564], [106.729805, 10.7595987], [106.7311325, 10.7600594], [106.7322159, 10.7609787], [106.7329178, 10.7620916], [106.7335434, 10.763588], [106.7340088, 10.7656603], [106.734314, 10.7688456], [106.7342987, 10.7706556], [106.7344513, 10.7718763], [106.7346954, 10.7734747], [106.7349777, 10.7744007], [106.7354507, 10.7753754], [106.7363663, 10.7765675], [106.7370834, 10.777051], [106.7379227, 10.7772913], [106.7393494, 10.7774048], [106.7404099, 10.7773991], [106.7416382, 10.7771721], [106.7430115, 10.7766762], [106.7436752, 10.77635], [106.7442169, 10.776083], [106.7452393, 10.7753916], [106.7466583, 10.7741518], [106.7475128, 10.7731953], [106.7482376, 10.7725677], [106.7491302, 10.7717934], [106.7501297, 10.770957], [106.7505798, 10.770483], [106.7510452, 10.7697716], [106.7514038, 10.7690353], [106.7518005, 10.7679482], [106.7519913, 10.7672663], [106.7522736, 10.766221], [106.7524643, 10.7652693], [106.7525406, 10.7644882], [106.7525558, 10.7640438], [106.7525177, 10.7635508], [106.7523727, 10.7627354], [106.7521667, 10.761776], [106.7515564, 10.7600889], [106.7511215, 10.7591763], [106.750679, 10.7584476], [106.7501297, 10.7578716], [106.7484055, 10.7565174], [106.7467651, 10.7548923], [106.7455292, 10.7531214], [106.7442627, 10.7511206], [106.7438583, 10.7497816], [106.7436829, 10.7484999], [106.743721, 10.7469692], [106.7440414, 10.7452278], [106.7441483, 10.7449007], [106.7443695, 10.7441921], [106.7452011, 10.7431936], [106.7459412, 10.742362], [106.7470245, 10.7416945], [106.7478561, 10.7414408], [106.7489471, 10.7414761], [106.7501297, 10.7415524], [106.7522507, 10.7424297], [106.7545319, 10.7433138], [106.7555008, 10.743619], [106.7563553, 10.7437925], [106.7574234, 10.7438593], [106.7585373, 10.7438173], [106.759697, 10.7436485], [106.7607651, 10.743392], [106.7614136, 10.7431545], [106.762352, 10.7426662], [106.763649, 10.742013], [106.7667858, 10.7403457], [106.7656121, 10.7388033], [106.764866, 10.7377245], [106.7550705, 10.7253651], [106.7536556, 10.7234634], [106.7528834, 10.7219417], [106.752304, 10.7204199], [106.7519171, 10.7185809], [106.7517273, 10.7166237], [106.7512531, 10.713473], [106.7512311, 10.7127242], [106.7512245, 10.7123764], [106.7511678, 10.7103776], [106.7512155, 10.7092477], [106.751422, 10.7074537], [106.7519936, 10.7046983], [106.7520953, 10.7043535], [106.7499008, 10.7040968], [106.7493362, 10.7040529], [106.7483826, 10.7038345], [106.7468643, 10.7037601], [106.7453613, 10.7034941], [106.7445526, 10.7033033], [106.7433624, 10.7032442], [106.7417145, 10.7032747], [106.740181, 10.703371], [106.7387009, 10.7034569], [106.7375641, 10.7034702], [106.7372513, 10.7034731], [106.7361145, 10.7034578], [106.7356415, 10.7032576], [106.735199, 10.7028904], [106.7349091, 10.7023897], [106.7345734, 10.7016716], [106.7345123, 10.7015429], [106.7341766, 10.7002802], [106.7339935, 10.6992569], [106.7337036, 10.6984959], [106.733284, 10.6980619], [106.7327423, 10.697793], [106.7317505, 10.6978197], [106.7301712, 10.6981564], [106.7281113, 10.6987343], [106.7267532, 10.6991987], [106.7259827, 10.6996832], [106.7259064, 10.69977], [106.7258072, 10.6998796], [106.7257919, 10.7002287], [106.7259064, 10.7010555], [106.7259521, 10.7018633], [106.7258682, 10.7024727], [106.725563, 10.7033691], [106.7250748, 10.7042103], [106.7246628, 10.7049761], [106.7244873, 10.7055216], [106.7244263, 10.7060232], [106.724472, 10.7065029], [106.7247391, 10.7071552], [106.7255173, 10.7088728], [106.7257407, 10.7094059], [106.7258249, 10.7099104], [106.7257932, 10.7103717], [106.7257058, 10.7110064], [106.7254556, 10.7117611], [106.7252619, 10.7121488], [106.7241425, 10.7133123], [106.7232132, 10.714325], [106.7229614, 10.7149239], [106.7228775, 10.7153835], [106.7228165, 10.7157984], [106.7228622, 10.7161684], [106.7230148, 10.7166252], [106.7233887, 10.7171459], [106.7245407, 10.7185783], [106.7247849, 10.7191658], [106.7249451, 10.7197104], [106.7249374, 10.7201128], [106.7247849, 10.7205276], [106.7243881, 10.7209225], [106.7241538, 10.7210423], [106.7230072, 10.7216282], [106.7220001, 10.7220688], [106.7210999, 10.7223358], [106.7206192, 10.7224035], [106.7203751, 10.7223883], [106.7198944, 10.7222109], [106.719429, 10.721756], [106.719162, 10.7211475], [106.7188492, 10.7199717], [106.718689, 10.7195559], [106.7183609, 10.7191076], [106.7177963, 10.7189636], [106.7169418, 10.7191486], [106.7159653, 10.7194653], [106.7152557, 10.7196321], [106.7139359, 10.7199011], [106.7129517, 10.72019], [106.7123337, 10.7203903], [106.7116776, 10.7205677], [106.7112045, 10.7206268], [106.7106934, 10.7206011], [106.7098846, 10.7202063], [106.7090378, 10.7196751], [106.7085953, 10.7195692], [106.7082291, 10.7195873], [106.7080078, 10.719676], [106.7076416, 10.7199049], [106.707283, 10.7205772], [106.7071228, 10.7213202], [106.7070618, 10.7222281], [106.7071304, 10.723197], [106.7070465, 10.7238302], [106.706871, 10.7242451], [106.7066345, 10.7245083], [106.7060623, 10.7248163], [106.7053604, 10.7250605], [106.7045288, 10.7253036], [106.7038359, 10.7253601], [106.703154, 10.7252041], [106.7017811, 10.7249104], [106.7012767, 10.7247636], [106.700763, 10.7246902], [106.7003403, 10.7246189], [106.6997223, 10.724535], [106.6988831, 10.7244301], [106.6983566, 10.724412], [106.6976929, 10.724432], [106.6974792, 10.7244377], [106.6969299, 10.7244854], [106.6964798, 10.7245874], [106.6957245, 10.7247686], [106.6923065, 10.7255888], [106.6922455, 10.7255888], [106.6918488, 10.7255697], [106.6914749, 10.7255278], [106.6910172, 10.7254219], [106.6906433, 10.7253361], [106.6902365, 10.7253805], [106.6902193, 10.7271687], [106.6901962, 10.7279152], [106.6901985, 10.7283359], [106.6901905, 10.7296001]
                ],
                Name: "Quận 7",
                Location: "Quận 7, Tp.Hồ Chí Minh",
                symbol: {
                    type: "simple-fill",
                    color: [131, 132, 171, 0.5],
                    outline: {
                        color: [202, 113, 0],
                        width: 1
                    }
                },
                popupTemplate: point_medical_quarantine_facility
            },
            {
                type: "polyline",
                paths: [
                    [106.70936853561214, 10.826373976210547], [106.70799774680339, 10.826307829273752], [106.70664016124071, 10.826110025581643], [106.70530885494645, 10.825782470349955], [106.70401665072337, 10.825328318533641], [106.70277599460262, 10.824751944426811], [106.70159883592795, 10.824058899514199], [106.70049651223287, 10.823255858980884], [106.69947964002125, 10.822350557396437], [106.69855801250453, 10.821351714194101], [106.69774050528095, 10.820268949663863], [106.69703499086565, 10.819112692269805], [106.69644826289434, 10.81789407818564], [106.6959859707298, 10.816624844017172], [106.69565256509955, 10.81531721374601], [106.6954512552869, 10.813983780984342], [106.69538397828488, 10.812637387675547], [106.69545138020881, 10.8112910004094], [106.69565281014275, 10.80995758554346], [106.69598632647734, 10.808649984333377], [106.69644871567509, 10.807380789274545], [106.69703552327948, 10.80616222284561], [106.6977410968675, 10.80500601982101], [106.69855864052948, 10.803923314285072], [106.69948028034993, 10.80292453243476], [106.70049714025781, 10.80201929220234], [106.70159942751452, 10.801216310663326], [106.70277652701647, 10.800523320120178], [106.70401710350414, 10.799946993668579], [106.70530921069403, 10.7994928809619], [106.7066404062839, 10.799165354791294], [106.70799787172533, 10.798967568994916], [106.70936853561214, 10.798901428100763], [106.71073919949899, 10.798967568994916], [106.7120966649404, 10.799165354791294], [106.71342786053026, 10.7994928809619], [106.71471996772016, 10.799946993668579], [106.71596054420783, 10.800523320120178], [106.71713764370976, 10.801216310663326], [106.71823993096649, 10.80201929220234], [106.71925679087435, 10.80292453243476], [106.72017843069482, 10.803923314285072], [106.72099597435678, 10.80500601982101], [106.72170154794482, 10.80616222284561], [106.72228835554921, 10.807380789274545], [106.72275074474696, 10.808649984333377], [106.72308426108157, 10.80995758554346], [106.72328569101549, 10.8112910004094], [106.72335309293943, 10.812637387675547], [106.7232858159374, 10.813983780984342], [106.72308450612474, 10.81531721374601], [106.7227511004945, 10.816624844017172], [106.72228880832995, 10.81789407818564], [106.72170208035865, 10.819112692269805], [106.72099656594335, 10.820268949663863], [106.72017905871976, 10.821351714194101], [106.71925743120303, 10.822350557396437], [106.71824055899144, 10.823255858980884], [106.71713823529635, 10.824058899514199], [106.71596107662168, 10.824751944426811], [106.71472042050092, 10.825328318533641], [106.71342821627785, 10.825782470349955], [106.71209690998359, 10.826110025581643], [106.71073932442091, 10.826307829273752], [106.70936853561214, 10.826373976210547]
                ],
                Name: "Nguy cấp",
                Location: "Khu vực nguy cấp",
                symbol: {
                    type: "simple-fill",
                    color: [232, 98, 88, 0.5],
                    outline: {
                        color: [214, 114, 101],
                        width: 1
                    }
                },
                popupTemplate: point_template_warning
            },
            {
                type: "polyline",
                paths: [
                    [106.70131922474093,10.783335927560088],[106.69517937385751,10.78000961751583],[106.69695371747184,10.771610145347509],[106.70562070866805,10.772146477380716],[106.70674673198005,10.779889667810409],[106.70131922474093,10.783335927560088]
                ],
                Name: "Nguy cấp",
                Location: "Khu vực nguy cấp",
                symbol: {
                    type: "simple-fill",
                    color: [232, 98, 88, 0.5],
                    outline: {
                        color: [214, 114, 101],
                        width: 1
                    }
                },
                popupTemplate: point_template_warning
            },
        ]
    };
    function MapInit(pointSearch) {
        require([
            "esri/Map",
            "esri/views/MapView",
            "esri/layers/FeatureLayer",
            "esri/Graphic",
            "esri/layers/GraphicsLayer",
            "esri/widgets/Search",
            "esri/widgets/Expand",
            "esri/widgets/BasemapToggle",
            "esri/widgets/Legend"
        ], function (
            Map,
            MapView,
            FeatureLayer,
            Graphic,
            GraphicsLayer,
            Search,
            Expand,
            BasemapToggle,
            Legend
        ) {

            const layer = new FeatureLayer({
                //            url: {}
                //,
                //            title: "Places of worship",
                //            outFields: ["name", "religion", "denomination"],
                //            popupTemplate: {
                //                title: "{name}",
                //                content: [
                //                    {
                //                        type: "fields",
                //                        fieldInfos: [
                //                            {
                //                                fieldName: "religion"
                //                            },
                //                            {
                //                                fieldName: "denomination"
                //                            }
                //                        ]
                //                    }
                //                ]
                //            }
            });

            const map = new Map({
                basemap: "gray-vector",
                layers: [layer]
            });

            //const map = new Map({
            //    basemap: "topo-vector"
            //    //  layers:  [this.graphicsLayer]
            //});
            const view = new MapView({
                container: "map",
                map: map,
                center: pointSearch ? [pointSearch.longitude, pointSearch.latitude] : [106.708549, 10.8032988],// longitude, latitude
                zoom: pointSearch ? 15 : 12,
                highlightOptions: {
                    color: "blue"
                }
            });



            var toggle = new BasemapToggle({
                view: view,
                nextBasemap: "osm",
                container: "BasemapToggleDiv"
            });
            view.ui.add(toggle, "top-right");

            var search = new Search({
                view: view
            });
            view.ui.add(search, "top-right");


            view.ui.add("controlsWidget", "bottom-right");
            document
                .getElementById("takeScreenshotButton")
                .addEventListener("click", () => {
                    view.takeScreenshot().then((screenshot) => {
                        downloadImage("screenshot.png", screenshot.dataUrl);
                    });
                });

            function downloadImage(filename, dataUrl) {
                if (!window.navigator.msSaveOrOpenBlob) {
                    const element = document.createElement("a");
                    element.setAttribute("href", dataUrl);
                    element.setAttribute("download", filename);
                    element.style.display = "none";
                    document.body.appendChild(element);
                    element.click();
                    document.body.removeChild(element);
                } else {
                    const byteString = atob(dataUrl.split(",")[1]);
                    const mimeString = dataUrl.split(",")[0].split(":")[1].split(";")[0];
                    const ab = new ArrayBuffer(byteString.length);
                    const ia = new Uint8Array(ab);
                    for (let i = 0; i < byteString.length; i++) {
                        ia[i] = byteString.charCodeAt(i);
                    }
                    const blob = new Blob([ab], { type: mimeString });

                    window.navigator.msSaveOrOpenBlob(blob, filename);
                }
            }

            //var legend = new Legend({
            //    view: view,
            //    layerInfos: [
            //        {
            //            layer: {},
            //            title: "Property Crimes for June 2002"
            //        }
            //    ]
            //});

            //view.ui.add(legend, "bottom-right");

            const legend = new Legend({
                view,
                container: "legendDiv"
            });

            // create empty FeatureLayer
            const clusterConfig = {
                type: "cluster",
                clusterRadius: "100px",

                popupTemplate: {

                    content:
                        [
                            {
                                type: "text", // TextContentElement
                                text: "This cluster represents {cluster_count} {GROUP} flight.<br>The predominance value is <B><I>{cluster_type_classification}", //Use the predominance value using the format given
                            }, {
                                type: "media", // MediaContentElement
                                mediaInfos: [
                                    {
                                        title: "<b>Count by Classfication</b>",
                                        type: "pie-chart",
                                        caption: "",
                                        value: {
                                            fields: ["ID", "GROUP"],
                                            normalizeField: null,
                                            tooltipField: "GROUP"
                                        }
                                    }]
                            }]
                },
                clusterMinSize: "24px",
                clusterMaxSize: "60px",
                labelingInfo: [{
                    deconflictionStrategy: "none",
                    labelExpressionInfo: {
                        expression: "Text($feature.cluster_count, '#,###')"
                    },
                    symbol: {
                        type: "text",
                        color: "#fff",
                        font: {
                            weight: "bold",
                            family: "Noto Sans",
                            size: "12px"
                        }
                    },
                    labelPlacement: "center-center",
                }]
            }

            const clusteringByClassification = {
                type: "unique-value",
                field: "LEVEL",
                defaultSymbol: { type: "simple-marker" },
                uniqueValueInfos: [{
                    value: "Mức độ 1",
                    symbol: {
                        type: "simple-marker",
                        size: 6,
                        color: "#15BC85",
                        outline: {
                            width: 0.5,
                            color: "#15BC85"
                        }
                    }
                }, {
                    value: "Mức độ 2",
                    symbol: {
                        type: "simple-marker",
                        size: 6,
                        color: "#FC9C3F",
                        outline: {
                            width: 0.5,
                            color: "#FC9C3F"
                        }
                    }
                }, {
                    value: "Mức độ 3",
                    symbol: {
                        type: "simple-marker",
                        size: 6,
                        color: "#a10d0d",
                        outline: {
                            width: 0.5,
                            color: "#a10d0d"
                        }
                    }
                }]
            }
            const featureLayer = new FeatureLayer({
                fields: [
                    {
                        name: "OBJECTID",
                        alias: "OBJECTID",
                        type: "oid"
                    },
                    {
                        name: "Name",
                        alias: "Name",
                        type: "string"
                    },
                    {
                        name: "ID",
                        alias: "ID",
                        type: "integer"
                    },
                    {
                        name: "Type",
                        alias: "Type",
                        type: "string"
                    },
                    {
                        name: "LEVEL",
                        alias: "Mức độ",
                        type: "string"
                    },
                    {
                        name: "ADDRESS",
                        alias: "Địa chỉ",
                        type: "string"
                    },
                    {
                        name: "NOTE",
                        alias: "Ghi chú",
                        type: "string"
                    },
                    {
                        name: "GROUP",
                        alias: "GROUP",
                        type: "integer"
                    }
                ],
                featureReduction: clusterConfig,
                objectIdField: "ObjectID",
                geometryType: "point",
                spatialReference: { wkid: 4326 },
                source: [],
                outFields: ["*"],
                renderer: clusteringByClassification,
                popupTemplate: {
                    title: "{Name}",
                    content: `Vị trí nhà bệnh nhân: <b>{ADDRESS}</b>.<br>
                            Cấp độ bệnh: <b>{LEVEL}</b>.<br>
                            Ghi chú: <b>{NOTE}</b>.<br>`
                }
            });

            var graphics = [];
            var graphic;
            for (var i = 0; i < patient.length; i++) {
                graphic = new Graphic({
                    geometry: {
                        type: "point",
                        latitude: patient[i].Latitude,
                        longitude: patient[i].Longitude
                    },
                    attributes: patient[i]
                });
                graphics.push(graphic);
            }
            const addEdits = {
                addFeatures: graphics
            };
            applyEditsToLayer(addEdits);

            function applyEditsToLayer(edits) {
                featureLayer
                    .applyEdits(edits)
                    .then(function (results) {
                        if (results.addFeatureResults.length > 0) {
                            var objectIds = [];
                            results.addFeatureResults.forEach(function (item) {
                                objectIds.push(item.objectId);
                            });
                            featureLayer
                                .queryFeatures({
                                    objectIds: objectIds
                                })
                                .then(function (results) {
                                    console.log(results.features.length, "features have been added.");
                                })
                        }
                    })
                    .catch(function (error) {
                        console.log(error);
                    });
            }



            const infoDiv = document.getElementById("infoDiv");
            view.ui.add(
                new Expand({
                    view,
                    content: infoDiv,
                    expandIcon: "list-bullet",
                    expanded: true
                }),
                "top-right"
            );

            //layer
            //    .when()
            //    .then(generateClusterConfig)
            //    .then((featureReduction) => {
            //        layer.featureReduction = featureReduction;

            //        const toggleButton = document.getElementById("toggle-cluster");
            //        toggleButton.addEventListener("click", toggleClustering);

            //        // To turn off clustering on a layer, set the
            //        // featureReduction property to null
            //        function toggleClustering() {
            //            let fr = layer.featureReduction;
            //            layer.featureReduction = fr && fr.type === "cluster" ? null : featureReduction;

            //            toggleButton.innerText =
            //                toggleButton.innerText === "Enable Clustering" ? "Disable Clustering" : "Enable Clustering";
            //        }

            //        view.whenLayerView(layer).then((layerView) => {
            //            const filterSelect = document.getElementById("filter");
            //            // filters the layer using a definitionExpression
            //            // based on a religion selected by the user
            //            filterSelect.addEventListener("change", (event) => {
            //                const newValue = event.target.value;
            //                const whereClause = newValue ? `religion = '${newValue}'` : null;
            //                layerView.filter = {
            //                    where: whereClause
            //                };
            //                // close popup for former cluster that no longer displays
            //                view.closePopup();
            //            });
            //        });
            //    })
            //    .catch((error) => {
            //        console.error(error);
            //    });


            //async function generateClusterConfig(layer) {

            //    // generates default popupTemplate
            //    const popupTemplate = await clusterPopupCreator
            //        .getTemplates({ layer })
            //        .then((popupTemplateResponse) => popupTemplateResponse.primaryTemplate.value);


            //    // generates default labelingInfo
            //    const { labelingInfo, clusterMinSize } = await clusterLabelCreator
            //        .getLabelSchemes({ layer, view })
            //        .then((labelSchemes) => labelSchemes.primaryScheme);


            //    return {
            //        type: "cluster",
            //        popupTemplate,
            //        labelingInfo,
            //        clusterMinSize,
            //        maxScale: 50000
            //    };
            //}

            var createGraphic = function (data) {
                return new Graphic({
                    geometry: data,
                    symbol: data?.symbol,
                    attributes: data,
                    popupTemplate: data?.popupTemplate
                });
            };

            var graphicsLayer = new GraphicsLayer();

            jsondata.lines.forEach(function (data) {
                graphicsLayer.add(createGraphic(data));
            });

            jsondata.points.forEach(function (data) {
                graphicsLayer.add(createGraphic(data));
            });
            graphicsLayer.add(createGraphic(pointSearch));

            map.add(graphicsLayer);
            map.add(featureLayer);

        });

    }
</script>

